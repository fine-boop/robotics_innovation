<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Log Artefact</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/css.css') }}">
    <script src="{{ url_for('static',filename='js/js.js') }}"></script>

    <!-- minimal CSS -->
    <style>
        body {
            max-width: 600px;
        }
        form {
            display: none;
        }
        label {
            display: block; margin-top: 12px;
        }
        input, select, button {
            width: 100%; 
        }
        button {
            margin-top: 2lvh;
        }
        input[type=text]:hover, input[type=text]:focus, input[type=number]:hover, input[type=number]:focus, button:hover {
            width: 100%;
        }
        .msg {
            margin-bottom: 16px;
            color: #b91c1c;
        }
        select {
            color: black;
        }
        option {
            color: black;
        }
    </style>
</head>
<body>
        <header class="heading">
    <h1 style="color:black;">Log an arefact</h1>
    <a href="/" class="heading1"><h4>Home</h4></a>
    <a href="/my_sites" class="heading1"><h4>My sites</h4></a>
    <a href="/join_site" class="heading1"><h4>Join a site</h4></a>
    <a href="/create_site" class="heading1"><h4>Create a site</h4></a>
    <a href="/sites" class="heading1"><h4>Browse sites</h4></a>
    <div class="hovering">
        <h4 class="hovering-text">Profile</h4>
        <div class="hovering-content">
            <a href="/logout" class="heading3"><h6 class="heading3">Logout</h6></a>
            <a href="/profile" class="heading3"><h6 class="heading3">about</h6></a>
        </div>
    </div>
    </header>


<div class="everything-but-header">
<!-- flashed messages -->
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="msg">
      {% for message in messages %}
        <div>{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

{% if no_sites %}
    <p>You donâ€™t belong to any sites.</p>
{% else %}

<form method="POST" id="artefactForm">
    <label>
        Artefact name
        <input type="text" name="name" required>
    </label>

    <label>
        Weight (kg)
        <input type="number" name="weight" step="0.01" required>
    </label>



    <label>
        Site
        <select name="site" required>
            <option value="">Select a site</option>
            {% for site_id, site_name in sites %}
                <option value="{{ site_id }}">{{ site_name }}</option>
            {% endfor %}
        </select>
    </label>

    <button type="submit">Log artefact</button>
</form>
</div>
{% endif %}

<!-- JS-heavy, CSS-light -->
<script>
(() => {
    const form = document.getElementById("artefactForm");
    if (!form) return;

    // reveal form only when JS loads
    form.style.display = "block";

    // client-side sanity checks
    form.addEventListener("submit", e => {
        const weight = form.weight.value;
        if (weight <= 0) {
            alert("Weight must be greater than 0");
            e.preventDefault();
        }
    });
})();
</script>

</body>
</html>
